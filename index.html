<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>RadarNav Mobile</title>
<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
</head>
<body>
<div id="map"></div>

<!-- Alerts & Avg speed UI -->
<div id="alertPopup" class="hidden"><span id="alertText"></span></div>
<div id="avgZoneBar" class="hidden">
    <span id="avgSpeedVal">0</span> / <span id="zoneLimitVal">0</span> km/h
    <div id="progressContainer"><div id="progressFill"></div><div id="carMarker"></div></div>
</div>

<!-- PiP / speed overlay -->
<canvas id="pipCanvas" width="300" height="150"></canvas>
<video id="pipVideo" style="display:none;"></video>
<button id="pipToggle">Enable PiP</button>

<!-- Admin menu -->
<div id="adminMenu">
    <button id="testRadar">Test Radar Alert</button>
    <button id="testAvg">Test Average Speed Alert</button>
    <button id="closeAdmin">Close Admin</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nosleep/0.12.0/NoSleep.min.js"></script>
<script src="app.js"></script>
<script>
    // NoSleep to prevent mobile sleep
    const noSleep = new NoSleep();
    document.body.addEventListener('touchstart', () => noSleep.enable(), {once:true});

    // Admin menu
    const adminMenu = document.getElementById('adminMenu');
    document.body.addEventListener('dblclick',()=>adminMenu.classList.toggle('visible'));
    document.getElementById('testRadar').addEventListener('click',()=>showAlert('Radar ahead — 500 m'));
    document.getElementById('testAvg').addEventListener('click',()=>showAlert('Average speed camera ahead — 800 m'));
    document.getElementById('closeAdmin').addEventListener('click',()=>adminMenu.classList.remove('visible'));
</script>
</body>
</html>
